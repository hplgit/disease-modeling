<!DOCTYPE html>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Modeling the Spreading of Diseases">

<title>Modeling the Spreading of Diseases</title>







<!-- deck.js: https://github.com/imakewebthings/deck.js -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=1024, user-scalable=no">

<!-- Required stylesheet -->
<link rel="stylesheet" href="deck.js/core/deck.core.css">

<!-- Extension CSS files go here. Remove or add as needed.
deck.goto: Adds a shortcut key to jump to any slide number.
Hit g, type in the slide number, and hit enter.

deck.hash: Enables internal linking within slides, deep
linking to individual slides, and updates the address bar and
a permalink anchor with each slide change.

deck.menu: Adds a menu view, letting you see all slides in a grid.
Hit m to toggle to menu view, continue navigating your deck,
and hit m to return to normal view. Touch devices can double-tap
the deck to switch between views.

deck.navigation: Adds clickable left and right buttons for the
less keyboard inclined.

deck.status: Adds a page number indicator. (current/total).

deck.scale: Scales each slide to fit within the deck container
using CSS Transforms for those browsers that support them.

deck.pointer: Turn mouse into laser pointer (toggle with p).
(Requires https://github.com/mikeharris100/deck.pointer.js)
-->

<link rel="stylesheet" href="deck.js/extensions/menu/deck.menu.css">
<link rel="stylesheet" href="deck.js/extensions/navigation/deck.navigation.css">
<link rel="stylesheet" href="deck.js/extensions/scale/deck.scale.css">
<link rel="stylesheet" href="deck.js/extensions/pointer/deck.pointer.css">
<link rel="stylesheet" href="deck.js/extensions/notes/deck.notes.css">
<!--
<link rel="stylesheet" href="deck.js/extensions/goto/deck.goto.css">
<link rel="stylesheet" href="deck.js/extensions/hash/deck.hash.css">
<link rel="stylesheet" href="deck.js/extensions/status/deck.status.css">
-->

<!-- Style theme. More available in themes/style/ or create your own. -->
<link rel="stylesheet" href="deck.js/themes/style/sandstone.default.css">

<!--
<link rel="stylesheet" href="deck.js/themes/style/neon.css">
<link rel="stylesheet" href="deck.js/themes/style/swiss.css">
<link rel="stylesheet" href="deck.js/themes/style/web-2.0.css">

git clone git://github.com/duijf/mnml.git
<link rel="stylesheet" href="deck.js/themes/style/mnml.css">

git://github.com/groovecoder/deckjs-theme-mozilla.git
<link rel="stylesheet" href="deck.js/themes/style/sandstone.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.aurora.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.dark.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.default.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.firefox.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.light.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.mdn.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.nightly.css">
<link rel="stylesheet" href="deck.js/themes/style/sandstone.cbc.css">

git://github.com/barraq/deck.ext.js.git
<link rel="stylesheet" href="deck.js/themes/style/beamer.css">
-->

<!--
Transition theme. More available in /themes/transition/ or create your own. -->
<!--
<link rel="stylesheet" href="deck.js/themes/transition/horizontal-slide.css">
<link rel="stylesheet" href="deck.js/themes/transition/fade.css">
<link rel="stylesheet" href="deck.js/themes/transition/vertical-slide.css">
<link rel="stylesheet" href="deck.js/themes/transition/horizontal-slide.css">
-->

<!-- Required Modernizr file -->
<script src="deck.js/modernizr.custom.js"></script>

<style type="text/css">
/* Override h1, h2, ... styles */
h1 { font-size: 2.8em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.4em; }
h4 { font-size: 1.3em; }
h1, h2, h3, h4 { font-weight: bold; line-height: 1.2; }
body { overflow: auto; } /* vertical scrolling */

hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.slide .alert-text-small   { font-size: 80%;  }
.slide .alert-text-large   { font-size: 130%; }
.slide .alert-text-normal  { font-size: 90%;  }
.slide .alert {
     padding:8px 35px 8px 14px; margin-bottom:18px;
     text-shadow:0 1px 0 rgba(255,255,255,0.5);
     border:5px solid #bababa;
       -webkit-border-radius:14px; -moz-border-radius:14px;
     border-radius:14px
     background-position: 10px 10px;
     background-repeat: no-repeat;
     background-size: 38px;
     padding-left: 30px; /* 55px; if icon */
 }
 .slide .alert-block {padding-top:14px; padding-bottom:14px}
 .slide .alert-block > p, .alert-block > ul {margin-bottom:0}
 /*.slide .alert li {margin-top: 1em}*/
 .deck .alert-block p+p {margin-top:5px}
 /*.slide .alert-notice { background-image: url(http://hplgit.github.io/doconce/bundled/html_images//small_gray_notice.png); }
 .slide .alert-summary  { background-image:url(http://hplgit.github.io/doconce/bundled/html_images//small_gray_summary.png); }
 .slide .alert-warning { background-image: url(http://hplgit.github.io/doconce/bundled/html_images//small_gray_warning.png); }
 .slide .alert-question {background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */

</style>



<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>

<body class="deck-container">

<header>
<!-- Here goes a potential header -->
</header>

<!-- do not use the article tag - it gives strange sizings -->





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    



<section class="slide">
<!-- ------------------- main content ---------------------- -->

<!-- TITLE: Mathematical Modeling of the Spreading of Diseases -->

<h2 style="text-align: center;">Modeling the Spreading of Diseases</h2>  <!-- document title -->

<p>
<!-- author(s): Hans Petter Langtangen -->

<center>
<b style="font-weight: bold">Hans Petter Langtangen</b> [1, 2]
</center>

<p>
<!-- institution(s) -->

<center>[1] <b style="font-weight: bold">Center for Biomedical Computing, Simula Research Laboratory</b></center>
<center>[2] <b style="font-weight: bold">University of Oslo, Dept. of Informatics</b></center>
<p>
<center><b style="font-weight: bold">Nov 16, 2015</b></center> <!-- date -->
<p>
<center><p><img src="fig/disease1.jpg" align="bottom" width=400></p></center>
</section>


<section class="slide">

<h2 id="___sec0">We shall model a very complex phenomenon by simple math.... </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Assumptions:</b>
<ul>
 <p><li> We consider a perfectly mixed population in a confined area</li>
 <p><li> No spatial transport, just temporal evolution</li>
 <p><li> We do not consider individuals, just a grand mix of them<br />
   (cf. statistical mechanics vs thermodynamics)</li>
</ul>
</div>

<p>

<div class="slide alert alert-block alert-block alert-text-small">
<b style="font-weight: bold"></b>
<p>
We consider very simple models, but these can be extended to full
models that are used world-wide by health authorities. Typical
diseases modeled are flu, measles, swine flu, HIV, ...
</div>

<p>

<p class="slide">

All these slides and associated programs are available from
<a href="https://github.com/hplgit/disease-modeling" target="_blank"><tt>https://github.com/hplgit/disease-modeling</tt></a>.

</p>
</section>


<section class="slide">

<h2 id="___sec1">We keep track of 3 categories in the SIR model </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold"></b>
<ul>
 <p><li> <b style="font-weight: bold">S</b>: susceptibles - who can get the disease</li>
 <p><li> <b style="font-weight: bold">I</b>: infected - who have developed the disease and infect susceptibles</li>
 <p><li> <b style="font-weight: bold">R</b>: recovered - who have recovered and become immune</li>
</ul>
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Mathematical quantities:</b>
<p>
\( S(t) \), \( I(t) \), \( R(t) \): no of people in each category
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Goal:</b>
<p>
Find and solve equations for \( S(t) \), \( I(t) \), \( R(t) \)
</div>

<p>
<center><p><img src="fig/categories_SIR.png" align="bottom" width=400></p></center>
</section>


<section class="slide">

<h2 id="___sec2">The traditional modeling approach is very mathematical - our idea is to model, program and experiment </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold"></b>
<ul>
 <p><li> Numerous books on mathematical biology treat the SIR model</li>
 <p><li> Quick modeling step (max 2 pages)</li>
 <p><li> Nonlinear differential equation model</li>
 <p><li> Cannot solve the equations, so focus is on discussing
   stability (eigenvalues), qualitative properties, etc.</li>
 <p><li> Very few extensions of the model to real-life situations</li>
</ul>
</div>
</section>


<section class="slide">

<h2 id="___sec3">Dynamics in a time interval \( \Delta t \): \( \Delta t\,\beta SI \) people move from S to I </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">S-I interaction:</b>
<ul>

<p><li> In a mix of S and I people, there are \( SI \) possible pairs</li>

<p><li> A certain fraction \( \Delta t\,\beta \) of \( SI \) meet in a (small)
    time interval \( \Delta t \), with the result that the infected
    &quot;successfully&quot; infects the susceptible</li>

<p><li> The loss \( \Delta t\,\beta SI \) in the S catogory is a corresponding
    gain in the I category</li>
</ul>
</div>

<p>

<div class="slide alert alert-block alert-block alert-text-small">
<b style="font-weight: bold">Remark.</b>
<p>
It is reasonable that the fraction depends on \( \Delta t \)
(twice as many infected in \( 2\Delta t \) as in \( \Delta t \)).
\( \beta \) is some unknown parameter we must measure, supposed to not
depend on \( \Delta t \), but maybe time \( t \).
\( \beta \) lumps <em>a lot</em> of biological and sociological effects into
one number.
</div>
</section>


<section class="slide">

<h2 id="___sec4">For practical calculations, we must express the S-I interaction with symbols </h2>

<p>
Loss in \( S(t) \) from time \( t \) to \( t+\Delta t \):

<p>&nbsp;<br>
$$ S(t+\Delta t) = S(t) - \Delta t\,\beta S(t)I(t)$$
<p>&nbsp;<br>

<p>
Gain in \( I(t) \):

<p>&nbsp;<br>
$$ I(t+\Delta t) = I(t) + \Delta t\,\beta S(t)I(t)$$
<p>&nbsp;<br>
</section>


<section class="slide">

<h2 id="___sec5">Modeling the interaction between R and I </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">R-I interaction:</b>
<ul>
 <p><li> After some days, the infected has recovered and moves to the R category</li>
 <p><li> A simple model: in a small time \( \Delta t \) (say 1 day),
   a fraction \( \Delta t\,\nu \) of the infected are removed
   (\( \nu \) must be measured)</li>
</ul>
</div>

<p>
We must subtract this fraction in the balance equation for \( I \):

<p>&nbsp;<br>
$$ I(t+\Delta t) = I(t) + \Delta t\,\beta S(t)I(t) -\Delta t\,\nu I(t) $$
<p>&nbsp;<br>

<p>
The loss \( \Delta t\,\nu I \) is a gain in \( R \):

<p>&nbsp;<br>
$$ R(t+\Delta t) = R(t) + \Delta t\,\nu I(t)$$
<p>&nbsp;<br>
</section>


<section class="slide">

<h2 id="___sec6">We have three equations for \( S \), \( I \), and \( R \) </h2>

<p>&nbsp;<br>
$$
\begin{align}
S(t+\Delta t) &= S(t) - \Delta t\,\beta S(t)I(t)
\tag{1}\\ 
I(t+\Delta t) &= I(t) + \Delta t\,\beta S(t)I(t) -\Delta t\nu I(t)
\tag{2}\\ 
R(t+\Delta t) &= R(t) + \Delta t\,\nu I(t)
\tag{3}
\end{align}
$$
<p>&nbsp;<br>

<p>
<center><p><img src="fig/categories_SIR.png" align="bottom" width=400></p></center>

<p>
Before we can compute with these, we must

<ul>
 <p><li> know \( \beta \) and \( \nu \)</li>
 <p><li> know \( S(0) \) (many), \( I(0) \) (few), \( R(0) \) (0?)</li>
 <p><li> choose \( \Delta t \)</li>
</ul>
</section>


<section class="slide">

<h2 id="___sec7">The computation involves just simple arithmetics </h2>

<ul>
 <p><li> Set \( \Delta t=6 \) minutes</li>
 <p><li> Set \( \beta =0.0013 \), \( \nu =0.8333 \)</li>
 <p><li> Set \( S(0)=50 \), \( I(0)=1 \), \( R(0)=0 \)</li>
</ul>
<p>&nbsp;<br>
$$
\begin{align*}
S(\Delta t) &= S(0) - \Delta t\,\beta S(0)I(0)\approx 49.99\\ 
I(\Delta t) &= I(0) + \Delta t\,\beta S(0)I(0) -\Delta t\,\nu I(0)\approx 1.002\\ 
R(\Delta t) &= R(0) + \Delta t\,\nu I(0)\approx 0.0008333
\end{align*}
$$
<p>&nbsp;<br>

<ul>
 <p><li class="slide"> In reality, \( S \), \( I \), \( R \) are integers and events are discrete (meet, get sick)</li>
 <p><li class="slide"> In the model, we work with real numbers and continuous events</li>
 <p><li class="slide"> Reasonable approximation in a not too small population</li>
</ul>
</section>


<section class="slide">

<h2 id="___sec8">And we can continue... </h2>

<p>&nbsp;<br>
$$
\begin{align*}
S(2\Delta t) &= S(\Delta t) - \Delta t\,\beta S(\Delta t)I(\Delta t)\approx 49.87\\ 
I(2\Delta t) &= I(\Delta t) + \Delta t\,\beta S(\Delta t)I(\Delta t) -\Delta t\,\nu I(\Delta t)\approx 1.011\\ 
R(2\Delta t) &= R(\Delta t) + \Delta t\,\nu I(\Delta t)\approx 0.00167
\end{align*}
$$
<p>&nbsp;<br>

<p>
Repeat...

<p>&nbsp;<br>
$$
\begin{align*}
S(3\Delta t) &= S(2\Delta t) - \Delta t\,\beta S(2\Delta t)I(2\Delta t)\approx 49.98\\ 
I(3\Delta t) &= I(2\Delta t) + \Delta t\,\beta S(2\Delta t)I(2\Delta t) -\Delta t\,\nu I(2\Delta t)\approx 1.017\\ 
R(3\Delta t) &= R(2\Delta t) + \Delta t\,\nu I(2\Delta t)\approx 0.0025
\end{align*}
$$
<p>&nbsp;<br>

<p>

<p class="slide">

But this is getting boring! Let's ask a computer to do the work!

</p>
</section>


<section class="slide">

<h2 id="___sec9">First, some handy notation </h2>

<p>&nbsp;<br>
$$ S^n = S(n\Delta t),\quad I^n = I(n\Delta t),\quad R^n = R(n\Delta t)$$
<p>&nbsp;<br>

<p>&nbsp;<br>
$$ S^{n+1} = S((n+1)\Delta t),\quad I^{n+1} = I((n+1)\Delta t),\quad R^{n+1} = R((n+1)\Delta t)$$
<p>&nbsp;<br>

<p>
The equations can now be written more compactly (and computer friendly):

<p>&nbsp;<br>
$$
\begin{align}
S^{n+1} &= S^n - \Delta t\,\beta S^nI^n
\tag{4}\\ 
I^{n+1} &= I^n + \Delta t\,\beta S^nI^n -\Delta t\,\nu I^n
\tag{5}\\ 
R^{n+1} &= R^n + \Delta t\,\nu I^n
\tag{6}
\end{align}
$$
<p>&nbsp;<br>
</section>


<section class="slide">

<h2 id="___sec10">With variables, arrays, and a loop we can program </h2>

<p>
Suppose we want to compute until \( t=N\Delta t \), i.e., for \( n=0,1,\ldots,N-1 \).
We can store \( S^0, S^1, S^2, \ldots, S^N \) in an array (or list).

<p>
Python (Matlab):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">t = linspace(<span style="color: #B452CD">0</span>, N*dt, N+<span style="color: #B452CD">1</span>)  <span style="color: #228B22"># all time points</span>
S = zeros(N+<span style="color: #B452CD">1</span>)
I = zeros(N+<span style="color: #B452CD">1</span>)
R = zeros(N+<span style="color: #B452CD">1</span>)

<span style="color: #8B008B; font-weight: bold">for</span> n <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(N):
    S[n+<span style="color: #B452CD">1</span>] = S[n] - dt*beta*S[n]*I[n]
    I[n+<span style="color: #B452CD">1</span>] = I[n] + dt*beta*S[n]*I[n] - dt*nu*I[n]
    R[n+<span style="color: #B452CD">1</span>] = R[n] + dt*nu*I[n]
</pre></div>
</section>


<section class="slide">

<h2 id="___sec11">Here is the complete program </h2>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">beta = <span style="color: #B452CD">0.0013</span>
nu =<span style="color: #B452CD">0.8333</span>
dt = <span style="color: #B452CD">0.1</span>             <span style="color: #228B22"># 6 min (time measured in hours)</span>
D = <span style="color: #B452CD">30</span>               <span style="color: #228B22"># simulate for D days</span>
N = <span style="color: #658b00">int</span>(D*<span style="color: #B452CD">24</span>/dt)     <span style="color: #228B22"># corresponding no of hours</span>

<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">import</span> zeros, linspace
t = linspace(<span style="color: #B452CD">0</span>, N*dt, N+<span style="color: #B452CD">1</span>)
S = zeros(N+<span style="color: #B452CD">1</span>)
I = zeros(N+<span style="color: #B452CD">1</span>)
R = zeros(N+<span style="color: #B452CD">1</span>)

<span style="color: #8B008B; font-weight: bold">for</span> n <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(N):
    S[n+<span style="color: #B452CD">1</span>] = S[n] - dt*beta*S[n]*I[n]
    I[n+<span style="color: #B452CD">1</span>] = I[n] + dt*beta*S[n]*I[n] - dt*nu*I[n]
    R[n+<span style="color: #B452CD">1</span>] = R[n] + dt*nu*I[n]

<span style="color: #228B22"># Plot the graphs</span>
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">import</span> *
plot(t, S, <span style="color: #CD5555">&#39;k-&#39;</span>, t, I, <span style="color: #CD5555">&#39;b-&#39;</span>, t, R, <span style="color: #CD5555">&#39;r-&#39;</span>)
legend([<span style="color: #CD5555">&#39;S&#39;</span>, <span style="color: #CD5555">&#39;I&#39;</span>, <span style="color: #CD5555">&#39;R&#39;</span>], loc=<span style="color: #CD5555">&#39;lower right&#39;</span>)
xlabel(<span style="color: #CD5555">&#39;hours&#39;</span>)
show()
</pre></div>
</section>


<section class="slide">

<h2 id="___sec12">We have predicted a disease! </h2>

<p>
<center><p><img src="fig/SIR1.png" align="bottom" width=800></p></center>
</section>


<section class="slide">

<h2 id="___sec13">How much math and programming did we use? </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Math:</b>
<ul>
 <p><li> Plain arithmetics</li>
 <p><li> The concept of a graph (i.e., discrete function in time)</li>
 <p><li> Units</li>
 <p><li> Greek letters</li>
</ul>
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Programming:</b>
<ul>
 <p><li> Variable</li>
 <p><li> Array</li>
 <p><li> Loop</li>
 <p><li> Plotting</li>
</ul>
</div>
</section>


<section class="slide">

<h2 id="___sec14">Detour: The standard mathematical approach </h2>

<p>
We had from intuition established

<p>&nbsp;<br>
$$
\begin{align*}
S(t+\Delta t) &= S(t) - \Delta t\,\beta S(t)I(t)\\ 
I(t+\Delta t) &= I(t) + \Delta t\,\beta S(t)I(t) -\Delta t\,\nu I(t)\\ 
R(t+\Delta t) &= R(t) + \Delta t\,\nu I(t)
\end{align*}
$$
<p>&nbsp;<br>

<p>
The mathematician will now make <em>differential equations</em>.
Divide by \( \Delta t \) and rearrange:

<p>&nbsp;<br>
$$
\begin{align*}
\frac{S(t+\Delta t) - S(t)}{\Delta t} &= - \beta S(t)I(t)\\ 
\frac{I(t+\Delta t) - I(t)}{\Delta t} &= \beta t S(t)I(t) -\nu I(t)\\ 
\frac{R(t+\Delta t) - R(t)}{\Delta t} &= \nu R(t)
\end{align*}
$$
<p>&nbsp;<br>
</section>


<section class="slide">

<h2 id="___sec15">A derivative arises as \( \Delta t\rightarrow 0 \) </h2>

<p>
In any calculus book, the derivative of \( S \) at \( t \) is defined as

<p>&nbsp;<br>
$$ S'(t) = \lim_{t\rightarrow 0}\frac{S(t+\Delta t) - S(t)}{\Delta t}$$
<p>&nbsp;<br>

<p>
If we let \( \Delta t\rightarrow 0 \), we get derivatives on the left-hand side:

<p>&nbsp;<br>
$$
\begin{align*}
S'(t) &= - \beta S(t)I(t)\\ 
I'(t) &= \beta t S(t)I(t) -\nu I(t)\\ 
R'(t) &= \nu R(t)
\end{align*}
$$
<p>&nbsp;<br>

<p>
This is a 3x3 system of differential equations for the functions
\( S(t) \), \( I(t) \), \( R(t) \). For a unique solution, we need
\( S(0) \), \( I(0) \), \( R(0) \).
</section>


<section class="slide">

<h2 id="___sec16">Bad news: we cannot solve these equations! </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Time to ask a numerical methods expert:</b>
<p>
Replace the derivative with a <em>finite difference</em>, e.g.,

<p>&nbsp;<br>
$$ S'(t) \approx \frac{S(t+\Delta t) - S(t)}{\Delta t}$$
<p>&nbsp;<br>

which is accurate for small \( \Delta t \).
</div>

<p>
This brings us back to the first model, which we can solve
on a computer!
</section>


<section class="slide">

<h2 id="___sec17">Parameter estimation is needed for predictive modeling </h2>

<ul>
 <p><li> Any small \( \Delta t \) will do</li>
 <p><li> One can reason about \( \nu \) and say that \( 1/\nu \) is the mean
   recovery time for the disease (e.g., 1 week for a flu)</li>
 <p><li> \( \beta \) must in some way be measured, but we don't know what it means...</li>
</ul>
<p>

<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">So, what if we don't know \( \beta \)?</b>
<ul>
 <p><li> Can still learn about the <em>dynamics</em> of diseases</li>
 <p><li> Can find the sensitivity to and influence of \( \beta \)</li>
 <p><li> Can apply <em>parameter estimation</em> procedures to fit \( \beta \) to data</li>
</ul>
</div>
</section>


<section class="slide">

<h2 id="___sec18">Let us extend the model: no life-long immunity </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Assumption.</b>
<p>
After some time, people in the R category lose the immunity.
In a small time \( \Delta t \) this gives a leakage \( \Delta t\,\gamma R \)
to the S category. (\( 1/\gamma \) is the mean time for immunity.)
</div>

<p>
<center><p><img src="fig/categories_SIR_feedback.png" align="bottom" width=400></p></center>

<p>&nbsp;<br>
$$
\begin{align}
S^{n+1} &= S^n - \Delta t\,\beta S^nI^n + {\color{red}\Delta t\,\gamma R^n}
\tag{7}\\ 
I^{n+1} &= I^n + \Delta t\,\beta S^nI^n -\Delta t\,\nu I^n
\tag{8}\\ 
R^{n+1} &= R^n + \Delta t\,\nu R^n - {\color{red}\Delta t\,\gamma R^n}
\tag{9}
\end{align}
$$
<p>&nbsp;<br>

<p>
No complications in the computational model!
</section>


<section class="slide">

<h2 id="___sec19">The effect of loss of immunity </h2>

<p>
\( 1/\gamma = 50 \) days. \( \beta \) reduced by 2 and 4 (left and right, resp.):

<p>
<center><p><img src="fig/SIR2.png" align="bottom" width=950></p></center>
</section>


<section class="slide">

<h2 id="___sec20">What is the effect of vaccination? </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Assumptions.</b>
<p>
A fraction \( p \) of the S category, per time unit, is vaccinated with
success. Then in time \( \Delta t \), \( p\Delta t S \) will move to a
vaccinated category, V. This does not affect the I and R categories.
</div>

<p>
<center><p><img src="fig/categories_SIRV.png" align="bottom" width=400></p></center>

<p>&nbsp;<br>
$$
\begin{align}
S^{n+1} &= S^n - \Delta t\,\beta S^nI^n + \Delta t\,\gamma R^n - {\color{red}p\Delta t S^n}
\tag{10}\\ 
V^{n+1} &= V^n + {\color{red}p\Delta t S^n}
\tag{11}\\ 
I^{n+1} &= I^n + \Delta t\,\beta S^nI^n -\Delta t\,\nu I^n
\tag{12}\\ 
R^{n+1} &= R^n + \Delta t\,\nu R^n - \Delta t\,\gamma R^n
\tag{13}
\end{align}
$$
<p>&nbsp;<br>

<p>
<!-- Too much for Beamer... -->
Implementation: Just add array for \( V^n \) and add equation.
</section>


<section class="slide">

<h2 id="___sec21">Many possibilities for adjusting the model... </h2>

<p>
The effect of vaccination decreases over time, so we may move people back to
the S category (term proportional to \( \Delta t V \)).

<p>
<center><p><img src="fig/categories_SIRV_feedback.png" align="bottom" width=400></p></center>
</section>


<section class="slide">

<h2 id="___sec22">Effect of adding vaccination </h2>

<p>
<center><p><img src="fig/SIRV1.png" align="bottom" width=800></p></center>

<p>
(\( p=0.0005 \))
</section>


<section class="slide">

<h2 id="___sec23">What is the effect of an intensive vaccination campaign? </h2>

<p>
10 times more intense vaccination for 10 days, 6 days after outbreak:

<p>&nbsp;<br>
$$
\begin{equation*} p(t) = \left\lbrace\begin{array}{ll}
0.005,& 6\leq t\leq 15,\\ 
0,& \hbox{otherwise} \end{array}\right.\end{equation*}
$$
<p>&nbsp;<br>

<p>
Implementation: Let \( p^n \) be an array as \( V^n \). Set \( p^n=0.05 \) for
\( n=6\cdot 24/0.1,\ldots, 15\cdot 24/0.1 \) (\( \mbox{days}\cdot 24 /\Delta t \), 24 is hours per day).

<p>
<center><p><img src="fig/p_discont.png" align="bottom" width=400></p></center>
</section>


<section class="slide">

<h2 id="___sec24">Effect of vaccination campaign </h2>

<p>
<center><p><img src="fig/SIRV2.png" align="bottom" width=500></p></center>

<p>
Note:

<ul>
 <p><li> Mathematicians would be scared by the cusps on the curves...</li>
 <p><li> Could now let the computer run a lot of cases and find the optimal
   vaccination period</li>
</ul>
</section>


<section class="slide">

<h2 id="___sec25">We can experiment with other campaigns </h2>

<p>

<table border="0">
<tr>
<td class="padding">
<center><p><img src="fig/disease2.jpg" align="bottom" width=400></p></center>
</td>
<td class="padding">
Wearing masks lowers \( \beta \):

<p>&nbsp;<br>
$$
\begin{equation*} \beta(t) = \left\lbrace\begin{array}{ll}
\beta_1,& 0\leq t < 5,\\ 
\beta_2 < \beta_1,& t \geq 5\end{array}\right.
\end{equation*}
$$
<p>&nbsp;<br>

<p>
Very easy to implement. (Used to be complicated in differential
equation models...)
</td>
</tr>
</table>
</section>


<section class="slide">

<h2 id="___sec26">And now for something similar: zombification! </h2>

<p>
<center><p><img src="fig/zombie1.jpg" align="bottom" width=900></p></center>

<p>
<b style="font-weight: bold">Zombification</b>: The disease that turns you into a zombie.
</section>


<section class="slide">

<h2 id="___sec27">Zombie modeling is almost the same as SIR modeling </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Categories.</b>
<ol>
 <p><li> S: susceptible humans who can become zombies</li>
 <p><li> I: infected humans, being bitten by zombies</li>
 <p><li> Z: zombies</li>
 <p><li> R: removed individuals, either conquered zombies or dead humans</li>
</ol>
</div>

<p>
Mathematical quantities: \( S(t) \), \( I(t) \), \( Z(t) \), \( R(t) \)

<p>
Zombie movie: <em>The Night of the Living Dead</em>, Geoerge A. Romero, 1968
</section>


<section class="slide">

<h2 id="___sec28">Dynamics of the zombie SIZR model </h2>

<p>
<center><p><img src="fig/categories_SIZR.png" align="bottom" width=380></p></center>

<ol>
 <p><li class="slide"> Susceptibles are infected by zombies: \( -\Delta t\beta SZ \) in time \( \Delta t \) (cf. the \( \Delta t\,\beta SI \) term in the SIR model).</li>
 <p><li class="slide"> Susceptibles die naturally or get killed and then enter the removed category. The no of deaths in time \( \Delta t \) is \( \Delta t\delta_S S \).</li>
 <p><li class="slide"> We also allow new humans to enter the area with zombies (necessary in a war on zombies): \( \Delta t\Sigma \) during a time \( \Delta t \).</li>
 <p><li class="slide"> Some infected turn into zombies (Z): \( \Delta t\rho I \), while others die (R): \( \delta_I\Delta t I \).</li>
 <p><li class="slide"> Nobody from R can turn into Z (important - otherwise zombies win).</li>
 <p><li class="slide"> Killed zombies go to R: \( \Delta t\alpha SZ \).</li>
</ol>
</section>


<section class="slide">

<h2 id="___sec29">The four equations in the SIZR model for zombification </h2>

<p>&nbsp;<br>
$$
\begin{align*}
S^{n+1} &= S^n + \Delta t\,\Sigma - \Delta t\,\beta S^nZ - \Delta t\,\delta_S S^n\\ 
I^{n+1} &= I^n + \Delta t\,\beta S^nZ^n - \Delta t\,\rho I^n - \Delta t\,\delta_I I^n\\ 
Z^{n+1} &= Z^n + \Delta t\,\rho I^n - \Delta t\,\alpha S^nZ^n\\ 
R^{n+1} &= R^n + \Delta t\,\delta_S S^n  + \Delta t\,\delta_I I^n +
\Delta t\,\alpha S^nZ^n
\end{align*}
$$
<p>&nbsp;<br>

<p>
<div class="alert alert-block alert-block alert-text-small">
<b style="font-weight: bold">Interpretation of parameters:</b>
<ul>

<p><li> \( \Sigma \): no of new humans brought into the zombified area per unit time.</li>

<p><li> \( \beta \): the probability that a theoretically possible human-zombie pair actually meets physically, during a unit time interval, with the result that the human is infected.</li>

<p><li> \( \delta_S \): the probability that a susceptible human is killed or dies, in a unit time interval.</li>

<p><li> \( \delta_I \): the probability that an infected human is killed or dies, in a unit time interval.</li>

<p><li> \( \rho \): the probability that an infected human is turned into a zombie, during a unit time interval.</li>

<p><li> \( \alpha \): the probability that, during a unit time interval, a theoretically possible human-zombie pair fights and the human kills the zombie.</li>
</ul>
</div>
</section>


<section class="slide">

<h2 id="___sec30">Simulate a zombie movie! </h2>

<p>

<table border="0">
<tr>
<td class="padding">
<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">Three fundamental phases.</b>
<ol>
<p><li> The initial phase (4 h)</li>
<p><li> The hysteric phase (24 h)</li>
<p><li> The counter attack phase (5 h)</li>
</ol>
</div>

</td>
<td class="padding">
<center><p><img src="fig/TNotLD.png" align="bottom" width=300></p></center>
</td>
</tr>
</table>

<p>

<p class="slide">

How do we do this? As \( p \) in the vaccination campaign - the parameters
take on different constant values in different time intervals.

</p>

<p>

<p class="slide">

H. P. Langtangen, K.-A. Mardal and P. RÃ¸tnes:
Escaping the Zombie Threat by Mathematics, in
A. Whelan et al.: <em>Zombies in the Academy - Living Death in Higher Education</em>,
University of Chicago Press, 2013

</p>
</section>


<section class="slide">

<h2 id="___sec31">Effective war on zombies </h2>

<p>
Introduce attacks on zombies at selected times \( T_0, T_1, \ldots, T_m \).

<p>
Model: Replace \( \alpha \) by

<p>&nbsp;<br>
$$ \alpha_0 + \omega (t),$$
<p>&nbsp;<br>

where \( \alpha_0 \) is constant and \( \omega(t) \) is a series of
Gaussian functions (peaks) in time:

<p>&nbsp;<br>
$$ \omega(t) = a\sum_{i=0}^m \exp{\left(-\frac{1}{2}\left({t - T_i\over\sigma}\right)\right)}
$$
<p>&nbsp;<br>

<p>
Must experiment with values of \( a \) (strength), \( \sigma \) (duration is \( 6\sigma \)),
point of attacks (\( T_i \)) - with proper values humans beat the zombies!
</section>


<section class="slide">

<h2 id="___sec32">Summary </h2>

<ul>
 <p><li> A complex spreading of diseases can be modeled by intuitive, simple
   accounting of movement between categories</li>
 <p><li> Such models are knowns as <em>compartment models</em></li>
 <p><li> Result: difference equations that are easy to simulate on a computer</li>
 <p><li> (Can let \( \Delta t\rightarrow 0 \) and get differential equations)</li>
 <p><li> Easy to add new effects (vaccination, campaigns, zombification)</li>
</ul>
<p>

<div class="alert alert-block alert-block alert-text-normal">
<b style="font-weight: bold">All these slides and associated programs are available.</b>
<p>
Site: <a href="https://github.com/hplgit/disease-modeling" target="_blank"><tt>https://github.com/hplgit/disease-modeling</tt></a>. Just do

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eeeedd"><pre style="line-height: 125%">git clone https://github.com/hplgit/disease-modeling.git
</pre></div>

</div>
</section>




<footer>
<!-- Here goes a footer -->
</footer>

<!-- Begin extension snippets. Add or remove as needed. -->

<!-- deck.navigation snippet -->
<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<!-- deck.status snippet
<p class="deck-status">
	<span class="deck-status-current"></span>
	/
	<span class="deck-status-total"></span>
</p>
-->

<!-- deck.goto snippet
<form action="." method="get" class="goto-form">
	<label for="goto-slide">Go to slide:</label>
	<input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
	<datalist id="goto-datalist"></datalist>
	<input type="submit" value="Go">
</form>
-->

<!-- deck.hash snippet
<a href="." title="Permalink to this slide" class="deck-permalink">#</a>
-->

<!-- End extension snippets. -->


<!-- Required JS files. -->
<script src="deck.js/jquery.min.js"></script>
<script src="deck.js/core/deck.core.js"></script>

<!-- Extension JS files. Add or remove as needed. -->
<script src="deck.js/core/deck.core.js"></script>
<script src="deck.js/extensions/hash/deck.hash.js"></script>
<script src="deck.js/extensions/menu/deck.menu.js"></script>
<script src="deck.js/extensions/goto/deck.goto.js"></script>
<script src="deck.js/extensions/status/deck.status.js"></script>
<script src="deck.js/extensions/navigation/deck.navigation.js"></script>
<script src="deck.js/extensions/scale/deck.scale.js"></script>
<script src="deck.js/extensions/notes/deck.notes.js"></script>

<!-- From https://github.com/mikeharris100/deck.pointer.js -->
<script src="deck.js/extensions/pointer/deck.pointer.js"></script>

<!-- From https://github.com/stvnwrgs/presenterview
<script type="text/javascript" src="deck.js/extensions/presenterview/deck.presenterview.js"></script> -->

<!-- From https://github.com/nemec/deck.annotate.js
<script type="text/javascript" src="deck.js/extensions/deck.annotate.js/deck.annotate.js"></script>
-->


<!-- Initialize the deck. You can put this in an external file if desired. -->
<script>
	$(function() {
		$.deck('.slide');
	});
</script>


</body>
</html>
